<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø¯ÙŠØ± - Ù…Ø´ÙˆØ§Ø±ÙŠ</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Cairo', sans-serif;
            padding: 20px;
            background: #f0f2f5;
            text-align: center;
        }

        .admin-form {
            max-width: 400px;
            margin: 20px auto;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            display: none;
        }

        input {
            width: 90%;
            padding: 12px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-family: 'Cairo';
        }

        .btn-save {
            background: #2c3e50;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            width: 100%;
            font-weight: bold;
        }

        .btn-login {
            background: #4285F4;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
        }

        #uid-display {
            background: #ffebee;
            color: #c62828;
            padding: 10px;
            margin: 10px auto;
            max-width: 400px;
            border-radius: 8px;
            font-size: 12px;
            word-break: break-all;
            display: none;
            border: 1px dashed red;
        }
    </style>
</head>

<body>

    <h2>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ© ğŸ”</h2>

    <div id="login-section">
        <button class="btn-login" onclick="loginAdmin()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø¯ÙŠØ±</button>
    </div>

    <!-- Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡ Ø³ÙŠØ¸Ù‡Ø± Ù„Ùƒ Ø§Ù„Ù€ UID Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù„Ù†Ø³Ø®Ù‡ -->
    <div id="uid-display">
        <b>Ø±Ù‚Ù… ØªØ¹Ø±ÙŠÙÙƒ (UID):</b> <br> <span id="my-uid"></span> <br>
        <small>(Ø§Ù†Ø³Ø® Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù… ÙˆØ¶Ø¹Ù‡ ÙÙŠ Firebase Rules Ø§Ù„Ø¢Ù†)</small>
    </div>

    <div class="admin-form" id="admin-panel">
        <h3 id="welcome-text">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ</h3>
        <input type="text" id="driver-uid" placeholder="UID Ø§Ù„Ø³Ø§Ø¦Ù‚">
        <input type="text" id="driver-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø³Ø§Ø¦Ù‚">
        <input type="text" id="driver-phone" placeholder="Ù‡Ø§ØªÙ Ø§Ù„Ø³Ø§Ø¦Ù‚">
        <input type="text" id="car-model" placeholder="Ù…ÙˆØ¯ÙŠÙ„ Ø§Ù„Ø³ÙŠØ§Ø±Ø©">
        <input type="text" id="car-color" placeholder="Ù„ÙˆÙ† Ø§Ù„Ø³ÙŠØ§Ø±Ø©">
        <input type="text" id="car-plate" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù„ÙˆØ­Ø©">
        <button class="btn-save" onclick="saveDriver()">Ø­ÙØ¸ Ø§Ù„Ø³Ø§Ø¦Ù‚</button>
        <p id="msg"></p>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyD8R4p1WaBn6s4yQxWpZzUkfznphYUOqqs",
            authDomain: "web-app-fb3f8.firebaseapp.com",
            projectId: "web-app-fb3f8",
            storageBucket: "web-app-fb3f8.firebasestorage.app",
            messagingSenderId: "1067792665032",
            appId: "1:1067792665032:web:015d23d10e359490c2d8fd"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        window.loginAdmin = async () => { await signInWithPopup(auth, provider); };

        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById('login-section').style.display = 'none';
                document.getElementById('admin-panel').style.display = 'block';
                document.getElementById('uid-display').style.display = 'block';
                // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù€ UID ÙÙˆØ±Ø§Ù‹
                document.getElementById('my-uid').innerText = user.uid;
            }
        });

        window.saveDriver = async () => {
            const uid = document.getElementById('driver-uid').value;
            const data = {
                driverName: document.getElementById('driver-name').value,
                driverPhone: document.getElementById('driver-phone').value,
                carModel: document.getElementById('car-model').value,
                carColor: document.getElementById('car-color').value,
                carPlate: document.getElementById('car-plate').value,
                isAdminVerified: true
            };

            try {
                await setDoc(doc(db, "verified_drivers", uid), data);
                alert("âœ… ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­!");
            } catch (e) {
                console.error(e);
                alert("âŒ ÙØ´Ù„: ÙÙŠØ±Ø¨ÙŠØ² ÙŠØ±ÙØ¶ Ø§Ù„ÙƒØªØ§Ø¨Ø©. ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ù€ UID Ø§Ù„Ù…ÙˆØ¶Ø­ Ø¨Ø§Ù„Ø£Ø­Ù…Ø± Ù‡Ùˆ Ù†ÙØ³Ù‡ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯.");
            }
        };
    </script>
</body>

</html>